---
export interface Props {
    src: string;
    alt: string;
    description: string;
    credit?: string;
    width?: string | number;
    height?: string | number;
    class?: string;
    loading?: "eager" | "lazy";
}

const {
    src,
    alt,
    description,
    credit,
    width,
    height,
    class: className = "",
    loading = "lazy"
} = Astro.props;

// Get the file extension to verify it's a supported format
const fileExtension = src.split('.').pop()?.toLowerCase();
const supportedFormats = ['jpg', 'jpeg', 'png', 'gif', 'webp', 'avif', 'svg'];
const isSupported = supportedFormats.includes(fileExtension || '');

if (!isSupported) {
    console.warn(`Image format '${fileExtension}' may not be supported in all browsers.`);
}
---

<div class="image-container">
    <figure class={`image-component ${className}`}>
        <img
                src={src}
                alt={alt}
                width={width}
                height={height}
                loading={loading}
        />
        <figcaption>
            <p class="description"><em>{description}</em></p>
            {credit && <p class="credit">Source: {credit}</p>}
        </figcaption>
    </figure>
</div>

<style>
	.image-container {
		display: flex;
		justify-content: center;
		width: 100%;
		margin: 1.5rem 0;
	}

	.image-component {
		max-width: 100%;
		transition: transform 0.3s ease;
	}

	.image-component:hover {
		transform: scale(1.02);
	}

	.image-component img {
		max-width: 100%;
		height: auto;
		border-radius: 10px;
		border: 2px solid var(--secondary-text-color);
		box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
		transition: box-shadow 0.3s ease;
	}

	.image-component:hover img {
		box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.4);
	}

	.credit {
		font-size: 0.8rem;
		color: var(--secondary-text-color);
	}
</style>